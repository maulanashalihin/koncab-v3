import{s as ie,p as ue,f as _,a as O,g as v,h as E,A as P,c as B,d as x,j as h,i as q,x as o,B as z,C as ce,o as de,I as $,y as fe,D as re,l as R,m as K,n as F,K as H,J as ee,L as J,M as he,H as oe}from"../chunks/scheduler.2ba080f3.js";import{S as me,i as pe,f as _e,b as ve,d as ge,m as be,a as ye,t as xe,e as we}from"../chunks/index.e182e4d1.js";import{e as Z}from"../chunks/each.e59479a4.js";import{M as Ye}from"../chunks/Modal.8169fecd.js";import{b as te}from"../chunks/helper.1bedf073.js";import{d as S,p as Ce,a as U,L as W}from"../chunks/schema.b06cae25.js";function ae(c,e,t){const u=c.slice();return u[16]=e[t],u}function le(c,e,t){const u=c.slice();return u[16]=e[t],u}function De(c){let e,t='<div class="text-center">Tidak ada mutasi</div>';return{c(){e=_("div"),e.innerHTML=t,this.h()},l(u){e=v(u,"DIV",{class:!0,"data-svelte-h":!0}),P(e)!=="svelte-1oufl6f"&&(e.innerHTML=t),this.h()},h(){h(e,"class","border border-dashed py-20 text-gray-500")},m(u,a){q(u,e,a)},p:fe,d(u){u&&x(e)}}}function ke(c){let e,t,u='<tr><th class="text-left px-4 py-2 font-medium text-gray-900">Tanggal</th> <th class="text-left px-4 py-2 font-medium text-gray-900">Name</th> <th class="text-left px-4 py-2 font-medium text-gray-900">Status</th> <th class="text-left px-4 py-2 font-medium text-gray-900">Notes</th></tr>',a,r,s=Z(c[0]),l=[];for(let m=0;m<s.length;m+=1)l[m]=se(le(c,s,m));return{c(){e=_("table"),t=_("thead"),t.innerHTML=u,a=O(),r=_("tbody");for(let m=0;m<l.length;m+=1)l[m].c();this.h()},l(m){e=v(m,"TABLE",{class:!0});var g=E(e);t=v(g,"THEAD",{class:!0,"data-svelte-h":!0}),P(t)!=="svelte-17pongh"&&(t.innerHTML=u),a=B(g),r=v(g,"TBODY",{class:!0});var i=E(r);for(let n=0;n<l.length;n+=1)l[n].l(i);i.forEach(x),g.forEach(x),this.h()},h(){h(t,"class","ltr:text-left rtl:text-right"),h(r,"class","divide-y divide-gray-200"),h(e,"class","min-w-full divide-y-2 divide-gray-200 bg-white text-sm")},m(m,g){q(m,e,g),o(e,t),o(e,a),o(e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(r,null)},p(m,g){if(g&1){s=Z(m[0]);let i;for(i=0;i<s.length;i+=1){const n=le(m,s,i);l[i]?l[i].p(n,g):(l[i]=se(n),l[i].c(),l[i].m(r,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=s.length}},d(m){m&&x(e),re(l,m)}}}function se(c){let e,t,u=S(c[16].createdAt).format("DD-MM-YYYY")+"",a,r,s,l=c[16].name+"",m,g,i=c[16].keanggotaan+"",n,p,Y,d,y=c[16].status+"",D,V,w,b=(c[16].note||"")+"",I,k,T,j;return{c(){e=_("tr"),t=_("td"),a=R(u),r=O(),s=_("td"),m=R(l),g=R(" ("),n=R(i),p=R(")"),Y=O(),d=_("td"),D=R(y),V=O(),w=_("td"),I=R(b),k=O(),T=_("td"),j=O(),this.h()},l(N){e=v(N,"TR",{});var f=E(e);t=v(f,"TD",{class:!0});var L=E(t);a=K(L,u),L.forEach(x),r=B(f),s=v(f,"TD",{class:!0});var C=E(s);m=K(C,l),g=K(C," ("),n=K(C,i),p=K(C,")"),C.forEach(x),Y=B(f),d=v(f,"TD",{class:!0});var A=E(d);D=K(A,y),A.forEach(x),V=B(f),w=v(f,"TD",{class:!0});var M=E(w);I=K(M,b),M.forEach(x),k=B(f),T=v(f,"TD",{class:!0}),E(T).forEach(x),j=B(f),f.forEach(x),this.h()},h(){h(t,"class","whitespace-nowrap px-4 py-2 text-gray-700"),h(s,"class","whitespace-nowrap px-4 py-2 font-medium text-gray-900"),h(d,"class","whitespace-nowrap px-4 py-2 text-gray-700"),h(w,"class","whitespace-nowrap px-4 py-2 text-gray-700"),h(T,"class","whitespace-nowrap px-4 py-2 text-gray-700")},m(N,f){q(N,e,f),o(e,t),o(t,a),o(e,r),o(e,s),o(s,m),o(s,g),o(s,n),o(s,p),o(e,Y),o(e,d),o(d,D),o(e,V),o(e,w),o(w,I),o(e,k),o(e,T),o(e,j)},p(N,f){f&1&&u!==(u=S(N[16].createdAt).format("DD-MM-YYYY")+"")&&F(a,u),f&1&&l!==(l=N[16].name+"")&&F(m,l),f&1&&i!==(i=N[16].keanggotaan+"")&&F(n,i),f&1&&y!==(y=N[16].status+"")&&F(D,y),f&1&&b!==(b=(N[16].note||"")+"")&&F(I,b)},d(N){N&&x(e)}}}function Me(c){let e,t,u="Anggota",a,r,s,l="Pilih Anggota",m,g,i=Z(c[3]),n=[];for(let p=0;p<i.length;p+=1)n[p]=ne(ae(c,i,p));return{c(){e=_("div"),t=_("label"),t.textContent=u,a=O(),r=_("select"),s=_("option"),s.textContent=l;for(let p=0;p<n.length;p+=1)n[p].c();this.h()},l(p){e=v(p,"DIV",{class:!0});var Y=E(e);t=v(Y,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),P(t)!=="svelte-xt05ne"&&(t.textContent=u),a=B(Y),r=v(Y,"SELECT",{class:!0,id:!0});var d=E(r);s=v(d,"OPTION",{"data-svelte-h":!0}),P(s)!=="svelte-1yc6vi9"&&(s.textContent=l);for(let y=0;y<n.length;y+=1)n[y].l(d);d.forEach(x),Y.forEach(x),this.h()},h(){h(t,"for","name"),h(t,"class","font-medium"),s.disabled=!0,s.__value="",H(s,s.__value),r.required=!0,h(r,"class","bg-gray-50 border border-gray-300 outline-none text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 block w-full p-2.5 placeholder-gray-400"),h(r,"id","name"),c[1].name===void 0&&ee(()=>c[10].call(r)),h(e,"class","space-y-1")},m(p,Y){q(p,e,Y),o(e,t),o(e,a),o(e,r),o(r,s);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(r,null);J(r,c[1].name,!0),m||(g=z(r,"change",c[10]),m=!0)},p(p,Y){if(Y&8){i=Z(p[3]);let d;for(d=0;d<i.length;d+=1){const y=ae(p,i,d);n[d]?n[d].p(y,Y):(n[d]=ne(y),n[d].c(),n[d].m(r,null))}for(;d<n.length;d+=1)n[d].d(1);n.length=i.length}Y&2&&J(r,p[1].name)},d(p){p&&x(e),re(n,p),m=!1,g()}}}function Ee(c){let e,t,u="Nama",a,r,s,l,m,g="Status Anggota",i,n,p,Y="P",d,y="K",D,V;return{c(){e=_("div"),t=_("label"),t.textContent=u,a=O(),r=_("input"),s=O(),l=_("div"),m=_("label"),m.textContent=g,i=O(),n=_("select"),p=_("option"),p.textContent=Y,d=_("option"),d.textContent=y,this.h()},l(w){e=v(w,"DIV",{class:!0});var b=E(e);t=v(b,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),P(t)!=="svelte-nu0yl2"&&(t.textContent=u),a=B(b),r=v(b,"INPUT",{class:!0,type:!0,id:!0,placeholder:!0}),b.forEach(x),s=B(w),l=v(w,"DIV",{class:!0});var I=E(l);m=v(I,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),P(m)!=="svelte-hs85b7"&&(m.textContent=g),i=B(I),n=v(I,"SELECT",{class:!0,id:!0});var k=E(n);p=v(k,"OPTION",{"data-svelte-h":!0}),P(p)!=="svelte-1nuiry"&&(p.textContent=Y),d=v(k,"OPTION",{"data-svelte-h":!0}),P(d)!=="svelte-160gwns"&&(d.textContent=y),k.forEach(x),I.forEach(x),this.h()},h(){h(t,"for","name"),h(t,"class","font-medium"),r.required=!0,h(r,"class","bg-gray-50 border border-gray-300 outline-none text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 block w-full p-2.5 placeholder-gray-400"),h(r,"type","text"),h(r,"id","name"),h(r,"placeholder","Masukan Nama"),h(e,"class","space-y-1"),h(m,"for","status"),h(m,"class","font-medium"),p.__value="P",H(p,p.__value),d.__value="K",H(d,d.__value),n.required=!0,h(n,"class","bg-gray-50 border border-gray-300 outline-none text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 block w-full p-2.5 placeholder-gray-400"),h(n,"id","status"),c[2]===void 0&&ee(()=>c[9].call(n)),h(l,"class","space-y-1")},m(w,b){q(w,e,b),o(e,t),o(e,a),o(e,r),H(r,c[1].name),q(w,s,b),q(w,l,b),o(l,m),o(l,i),o(l,n),o(n,p),o(n,d),J(n,c[2],!0),D||(V=[z(r,"input",c[8]),z(n,"change",c[9])],D=!0)},p(w,b){b&2&&r.value!==w[1].name&&H(r,w[1].name),b&4&&J(n,w[2])},d(w){w&&(x(e),x(s),x(l)),D=!1,oe(V)}}}function ne(c){let e,t=c[16].name+"",u,a;return{c(){e=_("option"),u=R(t),this.h()},l(r){e=v(r,"OPTION",{});var s=E(e);u=K(s,t),s.forEach(x),this.h()},h(){e.__value=a=c[16].name,H(e,e.__value)},m(r,s){q(r,e,s),o(e,u)},p(r,s){s&8&&t!==(t=r[16].name+"")&&F(u,t),s&8&&a!==(a=r[16].name)&&(e.__value=a,H(e,e.__value))},d(r){r&&x(e)}}}function Te(c){let e,t,u,a="Status",r,s,l,m="Masuk",g,i="Keluar",n,p="Berhenti",Y,d,y,D,V="Catatan",w,b,I,k,T="Simpan",j,N;function f(A,M){return A[1].status=="Masuk"?Ee:Me}let L=f(c),C=L(c);return{c(){e=_("form"),t=_("div"),u=_("label"),u.textContent=a,r=O(),s=_("select"),l=_("option"),l.textContent=m,g=_("option"),g.textContent=i,n=_("option"),n.textContent=p,Y=O(),C.c(),d=O(),y=_("div"),D=_("label"),D.textContent=V,w=O(),b=_("textarea"),I=O(),k=_("button"),k.textContent=T,this.h()},l(A){e=v(A,"FORM",{class:!0});var M=E(e);t=v(M,"DIV",{class:!0});var X=E(t);u=v(X,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),P(u)!=="svelte-5o26ou"&&(u.textContent=a),r=B(X),s=v(X,"SELECT",{class:!0,id:!0});var G=E(s);l=v(G,"OPTION",{"data-svelte-h":!0}),P(l)!=="svelte-kvwu98"&&(l.textContent=m),g=v(G,"OPTION",{"data-svelte-h":!0}),P(g)!=="svelte-n61qvi"&&(g.textContent=i),n=v(G,"OPTION",{"data-svelte-h":!0}),P(n)!=="svelte-1of6z7i"&&(n.textContent=p),G.forEach(x),X.forEach(x),Y=B(M),C.l(M),d=B(M),y=v(M,"DIV",{class:!0});var Q=E(y);D=v(Q,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),P(D)!=="svelte-rpdbpz"&&(D.textContent=V),w=B(Q),b=v(Q,"TEXTAREA",{class:!0,id:!0,placeholder:!0}),E(b).forEach(x),Q.forEach(x),I=B(M),k=v(M,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),P(k)!=="svelte-1lszuks"&&(k.textContent=T),M.forEach(x),this.h()},h(){h(u,"for","status"),h(u,"class","font-medium"),l.__value="Masuk",H(l,l.__value),g.__value="Keluar",H(g,g.__value),n.__value="Berhenti",H(n,n.__value),s.required=!0,h(s,"class","bg-gray-50 border border-gray-300 outline-none text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 block w-full p-2.5 placeholder-gray-400"),h(s,"id","status"),c[1].status===void 0&&ee(()=>c[7].call(s)),h(t,"class","space-y-1"),h(D,"for","pertemuan"),h(D,"class","font-medium"),h(b,"class","bg-gray-50 border border-gray-300 outline-none text-gray-900 text-sm rounded-lg focus:ring-cyan-500 focus:border-cyan-500 block w-full p-2.5 placeholder-gray-400"),h(b,"id","note"),h(b,"placeholder","Catatan"),h(y,"class","space-y-1"),h(k,"type","submit"),h(k,"class","inline-flex justify-center items-center space-x-2 border font-semibold focus:outline-none w-full px-4 py-3 leading-6 rounded border-yellow-500 bg-yellow-500 text-white hover:text-white hover:bg-yellow-800 hover:border-yellow-800 focus:ring focus:ring-yellow-500 focus:ring-opacity-50 active:bg-yellow-700 active:border-yellow-700"),h(e,"class","p-4 space-y-4")},m(A,M){q(A,e,M),o(e,t),o(t,u),o(t,r),o(t,s),o(s,l),o(s,g),o(s,n),J(s,c[1].status,!0),o(e,Y),C.m(e,null),o(e,d),o(e,y),o(y,D),o(y,w),o(y,b),H(b,c[1].note),o(e,I),o(e,k),j||(N=[z(s,"change",c[7]),z(b,"input",c[11]),z(e,"submit",he(c[5]))],j=!0)},p(A,M){M&2&&J(s,A[1].status),L===(L=f(A))&&C?C.p(A,M):(C.d(1),C=L(A),C&&(C.c(),C.m(e,d))),M&2&&H(b,A[1].note)},d(A){A&&x(e),C.d(),j=!1,oe(N)}}}function Ae(c){let e,t,u,a,r="mutasi",s,l,m="Tambah",g,i,n,p='<input id="datepicker" class="px-3 py-2 w-full border outline-none focus:border-orange-400" type="text"/>',Y,d,y,D,V,w,b;function I(f,L){return f[0].length?ke:De}let k=I(c),T=k(c);function j(f){c[12](f)}let N={width:"max-w-lg",title:"Edit mutasi",$$slots:{default:[Te]},$$scope:{ctx:c}};return c[4]!==void 0&&(N.show=c[4]),y=new Ye({props:N}),ue.push(()=>_e(y,"show",j)),{c(){e=_("div"),t=_("div"),u=_("div"),a=_("div"),a.textContent=r,s=O(),l=_("button"),l.textContent=m,g=O(),i=_("div"),n=_("div"),n.innerHTML=p,Y=O(),T.c(),d=O(),ve(y.$$.fragment),this.h()},l(f){e=v(f,"DIV",{});var L=E(e);t=v(L,"DIV",{class:!0});var C=E(t);u=v(C,"DIV",{class:!0});var A=E(u);a=v(A,"DIV",{class:!0,"data-svelte-h":!0}),P(a)!=="svelte-1wn133u"&&(a.textContent=r),s=B(A),l=v(A,"BUTTON",{class:!0,"data-svelte-h":!0}),P(l)!=="svelte-5k8dah"&&(l.textContent=m),A.forEach(x),g=B(C),i=v(C,"DIV",{class:!0});var M=E(i);n=v(M,"DIV",{class:!0,"data-svelte-h":!0}),P(n)!=="svelte-1cjz4d8"&&(n.innerHTML=p),Y=B(M),T.l(M),M.forEach(x),C.forEach(x),L.forEach(x),d=B(f),ge(y.$$.fragment,f),this.h()},h(){h(a,"class","text-xl md:text-3xl"),h(l,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"),h(u,"class","flex flex-col md:flex-row gap-3 md:justify-between"),h(n,"class","lg:w-96 max-w-full mb-3"),h(i,"class","mt-10 overflow-x-auto"),h(t,"class","max-w-7xl mx-auto")},m(f,L){q(f,e,L),o(e,t),o(t,u),o(u,a),o(u,s),o(u,l),o(t,g),o(t,i),o(i,n),o(i,Y),T.m(i,null),q(f,d,L),be(y,f,L),V=!0,w||(b=z(l,"click",c[6]),w=!0)},p(f,[L]){k===(k=I(f))&&T?T.p(f,L):(T.d(1),T=k(f),T&&(T.c(),T.m(i,null)));const C={};L&2097166&&(C.$$scope={dirty:L,ctx:f}),!D&&L&16&&(D=!0,C.show=f[4],ce(()=>D=!1)),y.$set(C)},i(f){V||(ye(y.$$.fragment,f),V=!0)},o(f){xe(y.$$.fragment,f),V=!1},d(f){f&&(x(e),x(d)),T.d(),we(y,f),w=!1,b()}}}function Ie(c,e,t){let u=[],a={},r=S().subtract(1,"month").format("YYYY-MM-DD"),s=S().format("YYYY-MM-DD"),l="P",m=[];async function g(){t(0,u=await U.mutasi.where("createdAt").between(r,S(s).add(1,"day").format("YYYY-MM-DD")).reverse().sortBy("createdAt")),console.log(u),t(3,m=await U.peserta.toArray())}g();let i=!1;async function n(){const b=await U.peserta.where("name").equals(a.name).first();if(b&&a.status=="Masuk"){alert(`Nama ${b.name} sudah digunakan`);return}if(t(1,a.id=te(),a),t(1,a.createdAt=S().format("YYYY-MM-DD"),a),t(1,a.keanggotaan=l,a),await U.mutasi.add(a),a.status=="Masuk")await U.peserta.add({id:a.name,status:l,name:a.name,createdAt:S().format("YYYY-MM-DD")}),await W("peserta",{id:a.name,status:l,name:a.name,createdAt:S().format("YYYY-MM-DD")});else if(await U.peserta.delete(a.name),W("peserta",{id:a.id,status:l,name:a.name,createdAt:S().format("YYYY-MM-DD")},"delete"),a.status=="Berhenti"){const I={id:te(),name:a.name,status:"IA dari "+l,createdAt:S().format("YYYY-MM-DD")};await U.ia.add(I),W("ia",{id:a.id,status:l,name:a.name,createdAt:S().format("YYYY-MM-DD")},"delete")}W("mutasi",a),t(4,i=!1),g()}Ce.subscribe("mutasi",()=>{g()}),de(()=>{setTimeout(()=>{new easepick.create({element:document.getElementById("datepicker"),css:["https://cdn.jsdelivr.net/npm/@easepick/core@1.2.1/dist/index.css","https://cdn.jsdelivr.net/npm/@easepick/range-plugin@1.2.1/dist/index.css"],plugins:["RangePlugin"],RangePlugin:{tooltip:!0},setup(I){I.on("select",k=>{const{end:T,start:j}=k.detail;r=S(j).format("YYYY-MM-DD"),s=S(T).format("YYYY-MM-DD"),g()})}}).setDateRange(r,s),g()},100)});const p=()=>{t(4,i=!0),t(1,a={name:""})};function Y(){a.status=$(this),t(1,a)}function d(){a.name=this.value,t(1,a)}function y(){l=$(this),t(2,l)}function D(){a.name=$(this),t(1,a)}function V(){a.note=this.value,t(1,a)}function w(b){i=b,t(4,i)}return[u,a,l,m,i,n,p,Y,d,y,D,V,w]}class Se extends me{constructor(e){super(),pe(this,e,Ie,Ae,ie,{})}}export{Se as component};
